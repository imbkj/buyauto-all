<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.buyauto.mapper.orders.TOrdersMapper" >
 <resultMap id="BaseResultMap" type="com.buyauto.entity.orders.TOrders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="user_id" property="userId" jdbcType="BIGINT" />
    <result column="company_id" property="companyId" jdbcType="BIGINT" />
    <result column="product_id" property="productId" jdbcType="BIGINT" />
    <result column="car_id" property="carId" jdbcType="BIGINT" />
    <result column="configure" property="configure" jdbcType="VARCHAR" />
    <result column="configure_price" property="configurePrice" jdbcType="DECIMAL" />
    <result column="amount" property="amount" jdbcType="DECIMAL" />
    <result column="take_location" property="takeLocation" jdbcType="VARCHAR" />
    <result column="deliver_time" property="deliverTime" jdbcType="VARCHAR" />
    <result column="customer" property="customer" jdbcType="VARCHAR" />
    <result column="customer_tel" property="customerTel" jdbcType="VARCHAR" />
    <result column="deposit" property="deposit" jdbcType="DECIMAL" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="old_status" property="oldStatus" jdbcType="INTEGER" />
    <result column="pay_status" property="payStatus" jdbcType="INTEGER" />
    <result column="cancel_reason" property="cancelReason" jdbcType="VARCHAR" />
    <result column="message" property="message" jdbcType="VARCHAR" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="update_date" property="updateDate" jdbcType="TIMESTAMP" />
    <result column="resubmit" property="resubmit" jdbcType="INTEGER" />
    <result column="count" property="count" jdbcType="INTEGER" />
    <result column="version" property="version" jdbcType="INTEGER" />
    <result column="take_way" property="takeWay" jdbcType="INTEGER" />
    <result column="complete_time" property="completeTime" jdbcType="TIMESTAMP" />
    <result column="logistics_info" property="logisticsInfo" jdbcType="VARCHAR" />
    <result column="premiums" property="premiums" jdbcType="DECIMAL" />
    <result column="car_price" property="carPrice" jdbcType="DECIMAL" />
    <result column="supplier_id" property="supplierId" jdbcType="BIGINT" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, user_id, company_id, product_id, car_id, configure, configure_price, amount, 
    take_location, deliver_time, customer, customer_tel, deposit, status, old_status, 
    pay_status, cancel_reason, message, create_date, update_date, resubmit, count, version, 
    take_way, complete_time, logistics_info, premiums, car_price, supplier_id
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_orders
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from t_orders
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.buyauto.entity.orders.TOrders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_orders (id, user_id, company_id, 
      product_id, car_id, configure, 
      configure_price, amount, take_location, 
      deliver_time, customer, customer_tel, 
      deposit, status, old_status, 
      pay_status, cancel_reason, message, 
      create_date, update_date, resubmit, 
      count, version, take_way, 
      complete_time, logistics_info, premiums, 
      car_price, supplier_id)
    values (#{id,jdbcType=BIGINT}, #{userId,jdbcType=BIGINT}, #{companyId,jdbcType=BIGINT}, 
      #{productId,jdbcType=BIGINT}, #{carId,jdbcType=BIGINT}, #{configure,jdbcType=VARCHAR}, 
      #{configurePrice,jdbcType=DECIMAL}, #{amount,jdbcType=DECIMAL}, #{takeLocation,jdbcType=VARCHAR}, 
      #{deliverTime,jdbcType=VARCHAR}, #{customer,jdbcType=VARCHAR}, #{customerTel,jdbcType=VARCHAR}, 
      #{deposit,jdbcType=DECIMAL}, #{status,jdbcType=INTEGER}, #{oldStatus,jdbcType=INTEGER}, 
      #{payStatus,jdbcType=INTEGER}, #{cancelReason,jdbcType=VARCHAR}, #{message,jdbcType=VARCHAR}, 
      #{createDate,jdbcType=TIMESTAMP}, #{updateDate,jdbcType=TIMESTAMP}, #{resubmit,jdbcType=INTEGER}, 
      #{count,jdbcType=INTEGER}, #{version,jdbcType=INTEGER}, #{takeWay,jdbcType=INTEGER}, 
      #{completeTime,jdbcType=TIMESTAMP}, #{logisticsInfo,jdbcType=VARCHAR}, #{premiums,jdbcType=DECIMAL}, 
      #{carPrice,jdbcType=DECIMAL}), #{supplierId,jdbcType=BIGINT})
  </insert>
  <insert id="insertSelective" parameterType="com.buyauto.entity.orders.TOrders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_orders
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="companyId != null" >
        company_id,
      </if>
      <if test="productId != null" >
        product_id,
      </if>
      <if test="carId != null" >
        car_id,
      </if>
      <if test="configure != null" >
        configure,
      </if>
      <if test="configurePrice != null" >
        configure_price,
      </if>
      <if test="amount != null" >
        amount,
      </if>
      <if test="takeLocation != null" >
        take_location,
      </if>
      <if test="deliverTime != null" >
        deliver_time,
      </if>
      <if test="customer != null" >
        customer,
      </if>
      <if test="customerTel != null" >
        customer_tel,
      </if>
      <if test="deposit != null" >
        deposit,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="oldStatus != null" >
        old_status,
      </if>
      <if test="payStatus != null" >
        pay_status,
      </if>
      <if test="cancelReason != null" >
        cancel_reason,
      </if>
      <if test="message != null" >
        message,
      </if>
      <if test="createDate != null" >
        create_date,
      </if>
      <if test="updateDate != null" >
        update_date,
      </if>
      <if test="resubmit != null" >
        resubmit,
      </if>
      <if test="count != null" >
        count,
      </if>
      <if test="version != null" >
        version,
      </if>
      <if test="takeWay != null" >
        take_way,
      </if>
      <if test="completeTime != null" >
        complete_time,
      </if>
      <if test="logisticsInfo != null" >
        logistics_info,
      </if>
      <if test="premiums != null" >
        premiums,
      </if>
       <if test="carPrice != null" >
        car_price,
      </if>
       <if test="supplierId != null" >
        supplier_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=BIGINT},
      </if>
      <if test="companyId != null" >
        #{companyId,jdbcType=BIGINT},
      </if>
      <if test="productId != null" >
        #{productId,jdbcType=BIGINT},
      </if>
      <if test="carId != null" >
        #{carId,jdbcType=BIGINT},
      </if>
      <if test="configure != null" >
        #{configure,jdbcType=VARCHAR},
      </if>
      <if test="configurePrice != null" >
        #{configurePrice,jdbcType=DECIMAL},
      </if>
      <if test="amount != null" >
        #{amount,jdbcType=DECIMAL},
      </if>
      <if test="takeLocation != null" >
        #{takeLocation,jdbcType=VARCHAR},
      </if>
      <if test="deliverTime != null" >
        #{deliverTime,jdbcType=VARCHAR},
      </if>
      <if test="customer != null" >
        #{customer,jdbcType=VARCHAR},
      </if>
      <if test="customerTel != null" >
        #{customerTel,jdbcType=VARCHAR},
      </if>
      <if test="deposit != null" >
        #{deposit,jdbcType=DECIMAL},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="oldStatus != null" >
        #{oldStatus,jdbcType=INTEGER},
      </if>
      <if test="payStatus != null" >
        #{payStatus,jdbcType=INTEGER},
      </if>
      <if test="cancelReason != null" >
        #{cancelReason,jdbcType=VARCHAR},
      </if>
      <if test="message != null" >
        #{message,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateDate != null" >
        #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="resubmit != null" >
        #{resubmit,jdbcType=INTEGER},
      </if>
      <if test="count != null" >
        #{count,jdbcType=INTEGER},
      </if>
      <if test="version != null" >
        #{version,jdbcType=INTEGER},
      </if>
      <if test="takeWay != null" >
        #{takeWay,jdbcType=INTEGER},
      </if>
      <if test="completeTime != null" >
        #{completeTime,jdbcType=TIMESTAMP},
      </if>
      <if test="logisticsInfo != null" >
        #{logisticsInfo,jdbcType=VARCHAR},
      </if>
        <if test="premiums != null" >
        #{premiums,jdbcType=DECIMAL},
      </if>
         <if test="carPrice != null" >
        #{carPrice,jdbcType=DECIMAL},
      </if>
      <if test="supplierId != null" >
        #{supplierId,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.buyauto.entity.orders.TOrders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_orders
    <set >
      <if test="userId != null" >
        user_id = #{userId,jdbcType=BIGINT},
      </if>
      <if test="companyId != null" >
        company_id = #{companyId,jdbcType=BIGINT},
      </if>
      <if test="productId != null" >
        product_id = #{productId,jdbcType=BIGINT},
      </if>
      <!-- <if test="carId != null" > -->
        car_id = #{carId,jdbcType=BIGINT},
      <!-- </if> -->
      <if test="configure != null" >
        configure = #{configure,jdbcType=VARCHAR},
      </if>
      <if test="configurePrice != null" >
        configure_price = #{configurePrice,jdbcType=DECIMAL},
      </if>
      <if test="amount != null" >
        amount = #{amount,jdbcType=DECIMAL},
      </if>
      <if test="takeLocation != null" >
        take_location = #{takeLocation,jdbcType=VARCHAR},
      </if>
      <if test="deliverTime != null" >
        deliver_time = #{deliverTime,jdbcType=VARCHAR},
      </if>
      <if test="customer != null" >
        customer = #{customer,jdbcType=VARCHAR},
      </if>
      <if test="customerTel != null" >
        customer_tel = #{customerTel,jdbcType=VARCHAR},
      </if>
      <if test="deposit != null" >
        deposit = #{deposit,jdbcType=DECIMAL},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="oldStatus != null" >
        old_status = #{oldStatus,jdbcType=INTEGER},
      </if>
      <if test="payStatus != null" >
        pay_status = #{payStatus,jdbcType=INTEGER},
      </if>
      <if test="cancelReason != null" >
        cancel_reason = #{cancelReason,jdbcType=VARCHAR},
      </if>
      <if test="message != null" >
        message = #{message,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateDate != null" >
        update_date = #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="resubmit != null" >
        resubmit = #{resubmit,jdbcType=INTEGER},
      </if>
      <if test="count != null" >
        count = #{count,jdbcType=INTEGER},
      </if>
      <if test="version != null" >
        version = #{version,jdbcType=INTEGER},
      </if>
      <if test="takeWay != null" >
        take_way = #{takeWay,jdbcType=INTEGER},
      </if>
      <if test="completeTime != null" >
        complete_time = #{completeTime,jdbcType=TIMESTAMP},
      </if>
      <if test="logisticsInfo != null" >
        logistics_info = #{logisticsInfo,jdbcType=VARCHAR},
      </if>
        <if test="premiums != null" >
        premiums = #{premiums,jdbcType=DECIMAL},
      </if>
       <if test="carPrice != null" >
        car_price = #{carPrice,jdbcType=DECIMAL},
      </if>
      <if test="supplierId != null" >
        supplier_id = #{supplierId,jdbcType=BIGINT},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
   <update id="updateByPrimaryKey" parameterType="com.buyauto.entity.orders.TOrders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_orders
    set user_id = #{userId,jdbcType=BIGINT},
      company_id = #{companyId,jdbcType=BIGINT},
      product_id = #{productId,jdbcType=BIGINT},
      car_id = #{carId,jdbcType=BIGINT},
      configure = #{configure,jdbcType=VARCHAR},
      configure_price = #{configurePrice,jdbcType=DECIMAL},
      amount = #{amount,jdbcType=DECIMAL},
      take_location = #{takeLocation,jdbcType=VARCHAR},
      deliver_time = #{deliverTime,jdbcType=VARCHAR},
      customer = #{customer,jdbcType=VARCHAR},
      customer_tel = #{customerTel,jdbcType=VARCHAR},
      deposit = #{deposit,jdbcType=DECIMAL},
      status = #{status,jdbcType=INTEGER},
      old_status = #{oldStatus,jdbcType=INTEGER},
      pay_status = #{payStatus,jdbcType=INTEGER},
      cancel_reason = #{cancelReason,jdbcType=VARCHAR},
      message = #{message,jdbcType=VARCHAR},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      update_date = #{updateDate,jdbcType=TIMESTAMP},
      resubmit = #{resubmit,jdbcType=INTEGER},
      count = #{count,jdbcType=INTEGER},
      version = #{version,jdbcType=INTEGER},
      take_way = #{takeWay,jdbcType=INTEGER},
      complete_time = #{completeTime,jdbcType=TIMESTAMP},
      logistics_info = #{logisticsInfo,jdbcType=VARCHAR},
      premiums = #{premiums,jdbcType=DECIMAL},
      car_price = #{carPrice,jdbcType=DECIMAL},
      supplier_id = #{supplierId,jdbcType=BIGINT}
    where id = #{id,jdbcType=BIGINT}
  </update>
  
  <!-- 今日订单 经销商达时报 -->
	<select id="queryTodayOrder" resultType="java.lang.Integer">
		SELECT
			count(0)
			FROM
			t_orders
			WHERE
			company_id =#{companyId}
			AND
			date_format( create_date ,'%Y-%m-%d')
				= 
		  	date_format(now(),'%Y-%m-%d')
	</select>
	
		<!-- 待付款订单  经销商达时报 -->
	<select id="queryUnpaidOrder" resultType="java.lang.Integer">
		SELECT
			count(1)
			FROM
			t_orders
			WHERE
			company_id = #{companyId}
			AND
			`status` = 101
	</select>
	
	<!-- 待交付车辆  经销商达时报 -->
	<select id="queryWaitDeliverOrder" resultType="java.lang.Integer">
		SELECT
			COUNT(0)
			FROM
			t_orders
			WHERE
			company_id = #{companyId}
			AND
			`status` = 107
	</select>
	
	<select id = "queryDepositOrder" resultType="java.math.BigDecimal">
	SELECT
		SUM(tor.deposit)
		FROM
		t_orders tor LEFT JOIN
		t_orders_files tof ON
		tor.id =tof.order_id
		WHERE
		tor.company_id = #{companyId}
		and
		tof.type = 0
		AND 
		(tor.`status` &lt; 400
		or tor.`status`=404)
		AND
		tor.pay_status in(10,11,12)
		AND
		date_format( tof.create_date ,'%Y-%m-%d')
						= 
		date_format(now(),'%Y-%m-%d')
	</select>
  
  
  	<select id="queryRetainageOrder" resultType="java.math.BigDecimal">
  	SELECT
		SUM( tor.amount - tor.deposit )
		FROM
		t_orders tor LEFT JOIN
		t_orders_files tof ON
		tor.id =tof.order_id
		WHERE
		tor.company_id = #{companyId}
		and
		tof.type = 1
		AND 
		(tor.`status` &lt; 400
		or tor.`status`=404)
		AND
		tor.pay_status in(10,11,12)
		AND
		date_format( tof.create_date ,'%Y-%m-%d')
						= 
		date_format(now(),'%Y-%m-%d')
  	</select>
  	
  	<select id="queryDepositOvertime" resultMap="BaseResultMap">
  		SELECT
		 <include refid="Base_Column_List" />
		FROM
		t_orders
		WHERE
		pay_status = 0
		AND
		date_format(create_date,'%Y-%m-%d %H:%i')
		&lt;
		str_to_date(DATE_SUB(NOW(),INTERVAL 48 HOUR ),'%Y-%m-%d %H:%i')
  	</select>
  
      <!-- 根据carId查找 -->
	  <select id="getOrderByCarId" resultMap="BaseResultMap" parameterType="java.lang.Long">
	  	SELECT
	  		<include refid="Base_Column_List"></include>
	  	FROM t_orders 
	  	WHERE t_orders.car_id = #{carId}
	  </select>
	  <!-- 自动确认收车 -->
	  <select id="queryAutomaticTakeCar" resultMap="BaseResultMap">
	  	SELECT
		 <include refid="Base_Column_List" />
		FROM
		t_orders
		WHERE
		status = 107
		AND
		date_format(update_date,'%Y-%m-%d %H:%i')
		&lt;
		str_to_date(DATE_SUB(NOW(),INTERVAL 10 DAY ),'%Y-%m-%d %H:%i')
	  </select>
	  
	  <!-- 查询用户是否可以升级 总月 -->
	  <select id="queryTotalExamine" resultType="java.lang.Integer"> 
	  	SELECT
		#{totalSales} &lt;= 
		(SELECT
		 count(*)
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt;= str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{month} MONTH ),'%Y-%m-%d %H:%i')
		)
		AND
		#{totalAmount} &lt;=(
		SELECT
		 sum(amount) 
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt;= str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{month} MONTH ),'%Y-%m-%d %H:%i')
		)
	  </select>
	  
	  <!-- 查询用户是否可以升级每月 -->
	  <select id="queryEachExamine" resultType="java.lang.Integer">
	  	SELECT
		#{monthlySales} &lt;= 
		(SELECT
		 count(*)
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{startMonth} MONTH ),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{endMonth} MONTH ),'%Y-%m-%d %H:%i')
		)
		AND
		#{monthlyAmount} &lt;=(
		SELECT
		 sum(amount) 
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt;= str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{startMonth} MONTH ),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{endMonth} MONTH ),'%Y-%m-%d %H:%i')
		)
	  </select>
	  
	  
	  <!-- 查询用户是否可降级 总月 -->
	  <select id="queryTotalExamineDownGrade" resultType="java.lang.Integer">
		SELECT
		#{totalSales} &gt;= 
		(SELECT
		 count(*)
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt;= str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{month} MONTH ),'%Y-%m-%d %H:%i')
		)
		AND
		#{totalAmount} &gt;=(
		SELECT
		 sum(amount) 
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt;= str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{month} MONTH ),'%Y-%m-%d %H:%i')
		)
	  </select>
	  
	  
	  <!-- 判断用户是否可以降级 每月 -->
	  <select id="queryEachExamineDownGrade" resultType="java.lang.Integer">	SELECT
		#{monthlySales} &gt;= 
		(SELECT
		 count(*)
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt;= str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{startMonth} MONTH ),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{endMonth} MONTH ),'%Y-%m-%d %H:%i')
		)
		AND
		#{monthlyAmount} &gt;=(
		SELECT
		 sum(amount) 
		FROM
		t_orders 
		WHERE
		user_id = #{id}
		and
		status = 200
		AND 
		update_date &lt;= str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{startMonth} MONTH ),'%Y-%m-%d %H:%i')
		AND
		update_date &gt; str_to_date(DATE_SUB((str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')),INTERVAL #{endMonth} MONTH ),'%Y-%m-%d %H:%i')
		)
	  </select>
	  
	  <select id="querySalesVolume" resultType="java.lang.Integer">
	  	SELECT
		count(*)
		FROM
		t_orders
		WHERE
		user_id = #{id}
		AND update_date &gt;  str_to_date(date_add(curdate(), interval - day(curdate()) + 1 day),'%Y-%m-%d %H:%i')
		AND update_date &lt;= NOW()
	  </select>
	   
</mapper>